# RxJava 알아보기

## RxJava 소개

- RxJava를 알아보려면, 먼저 'Reactive Extensions'에 대해 알고 있어야 한다.
- Reactive Extensions은 Reactive X라고도 부르며, 이벤트 기반 비동기 프로그래밍을 위한 라이브러리다.
  - Reactive Extension은 콜백 방씩(매 이벤트마다 그에 대응하는 동작을 정의하는 기존의 이벤트 처리 방식)과 달리 발생하는 이벤트를 이벤트 스트림에 전달하고, 이벤트 스트림을 관찰하다가 원하는 이벤트를 감지하면 이에 따른 동작을 수행하는 방식을 사용한다.

- RxJava는 'Reactive Extensions' 라이브러리의 JVM 구현체로, Reactive Extensions 라이브러리에서 제공하는 기능들을 안드로이드를 포함한 모든 자바 기반 플랫폼에서 사용할 수 있도록 한다.
- RxJava가 주목 받는 이유.
  - 첫째, 비동기 이벤트를 매우 쉽게 처리할 수 있다. 안드로이드에서 RxJava를 사용하지 않고 비동기 작업을 처리하려면 대부분의 경우 AsyncTask를 사용해야 한다. 하지만 작성해야 하는 코드의 양이 적지 않은데다 연속되는 비동기 작업을 처리하기도 쉽지 않다. RxJava를 사용하면 비동기 작업을 수행하는 코드를 단 몇줄로 작성할 수 있을 뿐 아니라, 각 작업들을 서로 간편하게 연결할 수 있어 연속되는 비동기 작업도 쉽게 구현할 수 있따.
  - 둘째, 이벤트나 데이터를 쉽게 가공 및 분배할 수 있다. RxJava를 사용하지 않는다면 어떠한 이벤트가 발생했을 때, 이벤트를 무시하거나 다른 형태로 변환하려면 경우에 따라 복잡한 형태의 if-else 문을 사용해야 한다. 하지만 RxJava를 사용하려면 스트림을 통해 이벤트가 전달되므로, 원본 이벤트 스트림에서 특정 이벤트만 받는 스트림을 새로 만드는 방식으로 다양한 조건에 대응하는 동작을 간편하게 구현할 수 있다.

## 옵저버블과 옵저버

- 옵저버블(Observable)은 이벤트를 만들어내는(emit) 주체로, 이벤트 스트림을 통해 만든 이벤트를 내보낸다. 옵저버블은 한 개 부터 여러 개까지 다양한 수의 이벤트를 만들어낼 수 있으며, 단 하나의 이벤트도 만들어내지 않는 경우도 있다.
- 또한, 옵저버블이 만드는 스트림은 특정 조건을 만족하면 종료되어 더 이상 이벤트를 만들어내지 않을 수도 있지만, 종료되지 않은 상태로 유지되면서 계속 이벤트를 만들어낼 수도 있다.
- 옵저버(Observer)는 옵저버블에서 만들어진 이벤트에 반응(react)하며, 이벤트를 받았을 때 수행할 작업을 정의한다. 이때, 옵저버가 옵저버블에서 만들어진 이벤트에 반응하려면 옵저버블에서 발생하는 이벤트를 옵저버가 관찰해야 하는데, 이를 '옵저버가 옵저버블을 구독(subscribe)한다'라고 표현한다.

## 연산자

- 연산자(Operators)는 이벤트 스트림을 통해 전달되는 이벤트를 변환한다. 단순히 이벤트가 갖고 있는 값을 다른 형태로 바꿔주는 것뿐 아니라 특정 조건을 만족하는 이벤트만 이벤트 스트림에 흘려보내거나 이벤트의 개수를 바꿔즈는 등 다양한 작업을 수행할 수 있다.
- 연산자는 중첩하여 사용할 수 있으며, 적용한 순서대로 연산자의 효과가 각 이벤트에 반영된다.

## 스케줄러

- 스케줄러(Scheduler)는 작업을 수행할 스레드(thread)를 지정한다. I/O 작업에 사용하는 스레드, 계산에 사용하는 스레드, 새로운 스레드 등 여러 종류의 스레드를 지정할 수 있으며 안드로이드에서는 UI를 업데이트할 수 있는 스레드인 메인 스레드를 사용할 수 있다.
- 스케줄러는 observeOn() 메서드를 사용하여 지정하며, 이 메서드를 호출한 직후에 오는 연산자나 옵저버에서 수행되는 작업이 앞의 observeOn() 메서드에서 지정한 스레드에서 실행된다.
- 안드로이드 메인 스레드에서 작업을 수행하기 위해 사용하는 스케줄러는 RxJava가 아닌 RxAndroid에 포함되어 있다. 따라서 안드로이드 애플리케이션에서 RxJava를 사용하는 경우 RxAndroid도 함께 의존성에 추가해야 한다.

## 디스포저블

- 디스포저블(Disposable)은 옵저버가 옵저버블을 구독할 때 생성되는 객체로, 옵저버블에서 만드는 이벤트 스트림과 이에 필요한 리소스를 관리한다.
- 옵저버블로부터 더 이상 이벤트를 받지 않으려면 디스포저블을 통해 구독 해제(unsubscribe)를 할 수 있다. 옵저버블은 이를 감지하여 자신을 구독하고 있는 옵저버가 더 이상 없는 경우 이벤트를 만들기 위해 유지하고 있던 리소스(예: 뷰에 대한 참조 등)를 해제한다.
- 구독 시 생성되는 디스포저블 객체를 하나씩 관리할 수 있지만, CompositeDisposable을 사용하면 여러 개의 디스포저블 객체를 하나의 객체에서 관리할 수 있다. 따라서 생명주기에 따라 리소스를 적절히 관리해야 하는 액티비티나 프래그먼트에서 CompositeDisposable을 자주 사용한다.